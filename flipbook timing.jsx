{  app.beginUndoGroup("Flipbook");  // set timing to flip up over .1 secs, stay viewable for .2 secs change this numbers to change timing var flipSecs = .1;  var viewableSecs =.2;   // add in some jitter so it looks more human and less computer  var jitter = false;      // scale images to 70% of comp size var scaleImages = 70;   var imagePos = [1600,780];    // Grab  current composition   var currentComp     = app.project.activeItem;   currentComp.openInViewer();                              // set timing for  each layer in current composition    //           for (var i = 1; i <currentComp.numLayers; i++)                for (var i = 1; i <currentComp.numLayers; i++)                {                     thisOne = currentComp.layers[i];                                // overshoot with a jittery motion                     if (jitter == true){                            // make the timing very slightly different for random amoutn of time to feel more hand-flipped                             jitterSecs=  (Math.floor(Math.random() * Math.floor(3)))/10;}                       else {                            // otherwise there's no jitter                           jitterSecs=0;}                              // set timing so each one shows for the number of viewable seconds                    hiddenAttTime = i*(flipSecs+viewableSecs);                    startFlip = hiddenAttTime;                         endFlip = hiddenAttTime+flipSecs;                    startWipe = endFlip+viewableSecs;                    endWipe = startWipe + flipSecs+jitterSecs;                                        var  msg = thisOne.name;                    msg = msg + "timings start flip "+startFlip +"\n";                     msg = msg + "end flip "+endFlip +"\n";                     msg = msg + "start wipe "+startWipe +"\n";                     msg = msg + "end wipe "+endWipe ;        //             alert(msg);                         // get rid of existing pageturn and wipe effects                    thisOne.effect.property("CC Page Turn").remove();                    thisOne.effect.property("Linear Wipe").remove();                                         // add the page turn effect to the images                                    var flipEffect = thisOne.effect.addProperty ("CC Page Turn");                           flipEffect.property("Fold Position").setValueAtTime(startFlip,beginFlipPos);                    flipEffect.property("Fold Position").setValueAtTime(endFlip,endFlipPos);                                        // add the wipe effect so that you can;t see larger images underneath smaller ones                    var wipeEffect = thisOne.effect.addProperty("Linear Wipe");                    wipeEffect.property("Wipe Angle").setValue(90);                    wipeEffect.property("Transition Completion").setValueAtTime(startWipe,0);                    wipeEffect.property("Transition Completion").setValueAtTime(endWipe,100);                                       totalSecs += flipSecs+viewableSecs;                                      /* example figures if    flipSecs = .5;  viewableSecs = 1;                                              layer 1                        page turn fold pos start -  	0                         page turn fold pos end      	0.12                         wipe start 			                   1.12                         wipe finish			                   2.02 secs                        layer 2                        page turn fold pos start -  	1.12 milisecs                        page turn fold pos end      	2.00 secs                        wipe start 			                   3.00 secs                        wipe finish			                   3.12 milisecs                       */                      }            // comment  out this line if you don't want to automatically  change composition duration            imgComp.duration = i*(flipSecs+viewableSecs)+flipSecs;       app.endUndoGroup();}